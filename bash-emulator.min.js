(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){"use strict";var ES=require("es-abstract/es6");module.exports=function findIndex(predicate){var list=ES.ToObject(this);var length=ES.ToLength(ES.ToLength(list.length));if(!ES.IsCallable(predicate)){throw new TypeError("Array#findIndex: predicate must be a function")}if(length===0)return-1;var thisArg=arguments[1];for(var i=0,value;i<length;i++){value=list[i];if(ES.Call(predicate,thisArg,[value,i,list]))return i}return-1}},{"es-abstract/es6":7}],2:[function(require,module,exports){"use strict";var define=require("define-properties");var ES=require("es-abstract/es6");var implementation=require("./implementation");var getPolyfill=require("./polyfill");var shim=require("./shim");var slice=Array.prototype.slice;var boundShim=function findIndex(array,predicate){ES.RequireObjectCoercible(array);return implementation.apply(array,predicate)};define(boundShim,{implementation:implementation,getPolyfill:getPolyfill,shim:shim});module.exports=boundShim},{"./implementation":1,"./polyfill":3,"./shim":4,"define-properties":5,"es-abstract/es6":7}],3:[function(require,module,exports){"use strict";module.exports=function getPolyfill(){var implemented=Array.prototype.findIndex&&[,1].findIndex(function(item,idx){return idx===0})===0;return implemented?Array.prototype.findIndex:require("./implementation")}},{"./implementation":1}],4:[function(require,module,exports){"use strict";var define=require("define-properties");var getPolyfill=require("./polyfill");module.exports=function shimArrayPrototypeFindIndex(){var polyfill=getPolyfill();define(Array.prototype,{findIndex:polyfill},{findIndex:function(){return Array.prototype.findIndex!==polyfill}});return polyfill}},{"./polyfill":3,"define-properties":5}],5:[function(require,module,exports){"use strict";var keys=require("object-keys");var foreach=require("foreach");var hasSymbols=typeof Symbol==="function"&&typeof Symbol()==="symbol";var toStr=Object.prototype.toString;var isFunction=function(fn){return typeof fn==="function"&&toStr.call(fn)==="[object Function]"};var arePropertyDescriptorsSupported=function(){var obj={};try{Object.defineProperty(obj,"x",{enumerable:false,value:obj});for(var _ in obj){return false}return obj.x===obj}catch(e){return false}};var supportsDescriptors=Object.defineProperty&&arePropertyDescriptorsSupported();var defineProperty=function(object,name,value,predicate){if(name in object&&(!isFunction(predicate)||!predicate())){return}if(supportsDescriptors){Object.defineProperty(object,name,{configurable:true,enumerable:false,value:value,writable:true})}else{object[name]=value}};var defineProperties=function(object,map){var predicates=arguments.length>2?arguments[2]:{};var props=keys(map);if(hasSymbols){props=props.concat(Object.getOwnPropertySymbols(map))}foreach(props,function(name){defineProperty(object,name,map[name],predicates[name])})};defineProperties.supportsDescriptors=!!supportsDescriptors;module.exports=defineProperties},{foreach:17,"object-keys":24}],6:[function(require,module,exports){"use strict";var $isNaN=require("./helpers/isNaN");var $isFinite=require("./helpers/isFinite");var sign=require("./helpers/sign");var mod=require("./helpers/mod");var IsCallable=require("is-callable");var toPrimitive=require("es-to-primitive/es5");var ES5={ToPrimitive:toPrimitive,ToBoolean:function ToBoolean(value){return Boolean(value)},ToNumber:function ToNumber(value){return Number(value)},ToInteger:function ToInteger(value){var number=this.ToNumber(value);if($isNaN(number)){return 0}if(number===0||!$isFinite(number)){return number}return sign(number)*Math.floor(Math.abs(number))},ToInt32:function ToInt32(x){return this.ToNumber(x)>>0},ToUint32:function ToUint32(x){return this.ToNumber(x)>>>0},ToUint16:function ToUint16(value){var number=this.ToNumber(value);if($isNaN(number)||number===0||!$isFinite(number)){return 0}var posInt=sign(number)*Math.floor(Math.abs(number));return mod(posInt,65536)},ToString:function ToString(value){return String(value)},ToObject:function ToObject(value){this.CheckObjectCoercible(value);return Object(value)},CheckObjectCoercible:function CheckObjectCoercible(value,optMessage){if(value==null){throw new TypeError(optMessage||"Cannot call method on "+value)}return value},IsCallable:IsCallable,SameValue:function SameValue(x,y){if(x===y){if(x===0){return 1/x===1/y}return true}return $isNaN(x)&&$isNaN(y)}};module.exports=ES5},{"./helpers/isFinite":9,"./helpers/isNaN":10,"./helpers/mod":12,"./helpers/sign":13,"es-to-primitive/es5":14,"is-callable":20}],7:[function(require,module,exports){"use strict";var toStr=Object.prototype.toString;var hasSymbols=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol";var symbolToStr=hasSymbols?Symbol.prototype.toString:toStr;var $isNaN=require("./helpers/isNaN");var $isFinite=require("./helpers/isFinite");var MAX_SAFE_INTEGER=Number.MAX_SAFE_INTEGER||Math.pow(2,53)-1;var assign=require("./helpers/assign");var sign=require("./helpers/sign");var mod=require("./helpers/mod");var isPrimitive=require("./helpers/isPrimitive");var toPrimitive=require("es-to-primitive/es6");var parseInteger=parseInt;var bind=require("function-bind");var strSlice=bind.call(Function.call,String.prototype.slice);var isBinary=bind.call(Function.call,RegExp.prototype.test,/^0b[01]+$/i);var isOctal=bind.call(Function.call,RegExp.prototype.test,/^0o[0-7]+$/i);var nonWS=["","​","￾"].join("");var nonWSregex=new RegExp("["+nonWS+"]","g");var hasNonWS=bind.call(Function.call,RegExp.prototype.test,nonWSregex);var invalidHexLiteral=/^[\-\+]0x[0-9a-f]+$/i;var isInvalidHexLiteral=bind.call(Function.call,RegExp.prototype.test,invalidHexLiteral);var ws=["\t\n\v\f\r   ᠎    ","         　\u2028","\u2029\ufeff"].join("");var trimRegex=new RegExp("(^["+ws+"]+)|(["+ws+"]+$)","g");var replace=bind.call(Function.call,String.prototype.replace);var trim=function(value){return replace(value,trimRegex,"")};var ES5=require("./es5");var hasRegExpMatcher=require("is-regex");var ES6=assign(assign({},ES5),{Call:function Call(F,V){var args=arguments.length>2?arguments[2]:[];if(!this.IsCallable(F)){throw new TypeError(F+" is not a function")}return F.apply(V,args)},ToPrimitive:toPrimitive,ToNumber:function ToNumber(argument){var value=isPrimitive(argument)?argument:toPrimitive(argument,"number");if(typeof value==="symbol"){throw new TypeError("Cannot convert a Symbol value to a number")}if(typeof value==="string"){if(isBinary(value)){return this.ToNumber(parseInteger(strSlice(value,2),2))}else if(isOctal(value)){return this.ToNumber(parseInteger(strSlice(value,2),8))}else if(hasNonWS(value)||isInvalidHexLiteral(value)){return NaN}else{var trimmed=trim(value);if(trimmed!==value){return this.ToNumber(trimmed)}}}return Number(value)},ToInt16:function ToInt16(argument){var int16bit=this.ToUint16(argument);return int16bit>=32768?int16bit-65536:int16bit},ToInt8:function ToInt8(argument){var int8bit=this.ToUint8(argument);return int8bit>=128?int8bit-256:int8bit},ToUint8:function ToUint8(argument){var number=this.ToNumber(argument);if($isNaN(number)||number===0||!$isFinite(number)){return 0}var posInt=sign(number)*Math.floor(Math.abs(number));return mod(posInt,256)},ToUint8Clamp:function ToUint8Clamp(argument){var number=this.ToNumber(argument);if($isNaN(number)||number<=0){return 0}if(number>=255){return 255}var f=Math.floor(argument);if(f+.5<number){return f+1}if(number<f+.5){return f}if(f%2!==0){return f+1}return f},ToString:function ToString(argument){if(typeof argument==="symbol"){throw new TypeError("Cannot convert a Symbol value to a string")}return String(argument)},ToObject:function ToObject(value){this.RequireObjectCoercible(value);return Object(value)},ToPropertyKey:function ToPropertyKey(argument){var key=this.ToPrimitive(argument,String);return typeof key==="symbol"?symbolToStr.call(key):this.ToString(key)},ToLength:function ToLength(argument){var len=this.ToInteger(argument);if(len<=0){return 0}if(len>MAX_SAFE_INTEGER){return MAX_SAFE_INTEGER}return len},CanonicalNumericIndexString:function CanonicalNumericIndexString(argument){if(toStr.call(argument)!=="[object String]"){throw new TypeError("must be a string")}if(argument==="-0"){return-0}var n=this.ToNumber(argument);if(this.SameValue(this.ToString(n),argument)){return n}return void 0},RequireObjectCoercible:ES5.CheckObjectCoercible,IsArray:Array.isArray||function IsArray(argument){return toStr.call(argument)==="[object Array]"},IsConstructor:function IsConstructor(argument){return this.IsCallable(argument)},IsExtensible:function IsExtensible(obj){if(!Object.preventExtensions){return true}if(isPrimitive(obj)){return false}return Object.isExtensible(obj)},IsInteger:function IsInteger(argument){if(typeof argument!=="number"||$isNaN(argument)||!$isFinite(argument)){return false}var abs=Math.abs(argument);return Math.floor(abs)===abs},IsPropertyKey:function IsPropertyKey(argument){return typeof argument==="string"||typeof argument==="symbol"},IsRegExp:function IsRegExp(argument){if(!argument||typeof argument!=="object"){return false}if(hasSymbols){var isRegExp=argument[Symbol.match];if(typeof isRegExp!=="undefined"){return ES5.ToBoolean(isRegExp)}}return hasRegExpMatcher(argument)},SameValueZero:function SameValueZero(x,y){return x===y||$isNaN(x)&&$isNaN(y)}});delete ES6.CheckObjectCoercible;module.exports=ES6},{"./es5":6,"./helpers/assign":8,"./helpers/isFinite":9,"./helpers/isNaN":10,"./helpers/isPrimitive":11,"./helpers/mod":12,"./helpers/sign":13,"es-to-primitive/es6":15,"function-bind":19,"is-regex":22}],8:[function(require,module,exports){var has=Object.prototype.hasOwnProperty;module.exports=Object.assign||function assign(target,source){for(var key in source){if(has.call(source,key)){target[key]=source[key]}}return target}},{}],9:[function(require,module,exports){var $isNaN=Number.isNaN||function(a){return a!==a};module.exports=Number.isFinite||function(x){return typeof x==="number"&&!$isNaN(x)&&x!==Infinity&&x!==-Infinity}},{}],10:[function(require,module,exports){module.exports=Number.isNaN||function isNaN(a){return a!==a}},{}],11:[function(require,module,exports){module.exports=function isPrimitive(value){return value===null||typeof value!=="function"&&typeof value!=="object"}},{}],12:[function(require,module,exports){module.exports=function mod(number,modulo){var remain=number%modulo;return Math.floor(remain>=0?remain:remain+modulo)}},{}],13:[function(require,module,exports){module.exports=function sign(number){return number>=0?1:-1}},{}],14:[function(require,module,exports){"use strict";var toStr=Object.prototype.toString;var isPrimitive=require("./helpers/isPrimitive");var isCallable=require("is-callable");var ES5internalSlots={"[[DefaultValue]]":function(O,hint){var actualHint=hint||(toStr.call(O)==="[object Date]"?String:Number);if(actualHint===String||actualHint===Number){var methods=actualHint===String?["toString","valueOf"]:["valueOf","toString"];var value,i;for(i=0;i<methods.length;++i){if(isCallable(O[methods[i]])){value=O[methods[i]]();if(isPrimitive(value)){return value}}}throw new TypeError("No default value")}throw new TypeError("invalid [[DefaultValue]] hint supplied")}};module.exports=function ToPrimitive(input,PreferredType){if(isPrimitive(input)){return input}return ES5internalSlots["[[DefaultValue]]"](input,PreferredType)}},{"./helpers/isPrimitive":16,"is-callable":20}],15:[function(require,module,exports){"use strict";var hasSymbols=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol";var isPrimitive=require("./helpers/isPrimitive");var isCallable=require("is-callable");var isDate=require("is-date-object");var isSymbol=require("is-symbol");var ordinaryToPrimitive=function OrdinaryToPrimitive(O,hint){if(typeof O==="undefined"||O===null){throw new TypeError("Cannot call method on "+O)}if(typeof hint!=="string"||hint!=="number"&&hint!=="string"){throw new TypeError('hint must be "string" or "number"')}var methodNames=hint==="string"?["toString","valueOf"]:["valueOf","toString"];var method,result,i;for(i=0;i<methodNames.length;++i){method=O[methodNames[i]];if(isCallable(method)){result=method.call(O);if(isPrimitive(result)){return result}}}throw new TypeError("No default value")};var GetMethod=function GetMethod(O,P){var func=O[P];if(func!==null&&typeof func!=="undefined"){if(!isCallable(func)){throw new TypeError(func+" returned for property "+P+" of object "+O+" is not a function")}return func}};module.exports=function ToPrimitive(input,PreferredType){if(isPrimitive(input)){return input}var hint="default";if(arguments.length>1){if(PreferredType===String){hint="string"}else if(PreferredType===Number){hint="number"}}var exoticToPrim;if(hasSymbols){if(Symbol.toPrimitive){exoticToPrim=GetMethod(input,Symbol.toPrimitive)}else if(isSymbol(input)){exoticToPrim=Symbol.prototype.valueOf}}if(typeof exoticToPrim!=="undefined"){var result=exoticToPrim.call(input,hint);if(isPrimitive(result)){return result}throw new TypeError("unable to convert exotic object to primitive")}if(hint==="default"&&(isDate(input)||isSymbol(input))){hint="string"}return ordinaryToPrimitive(input,hint==="default"?"number":hint)}},{"./helpers/isPrimitive":16,"is-callable":20,"is-date-object":21,"is-symbol":23}],16:[function(require,module,exports){arguments[4][11][0].apply(exports,arguments)},{dup:11}],17:[function(require,module,exports){var hasOwn=Object.prototype.hasOwnProperty;var toString=Object.prototype.toString;module.exports=function forEach(obj,fn,ctx){if(toString.call(fn)!=="[object Function]"){throw new TypeError("iterator must be a function")}var l=obj.length;if(l===+l){for(var i=0;i<l;i++){fn.call(ctx,obj[i],i,obj)}}else{for(var k in obj){if(hasOwn.call(obj,k)){fn.call(ctx,obj[k],k,obj)}}}}},{}],18:[function(require,module,exports){var ERROR_MESSAGE="Function.prototype.bind called on incompatible ";var slice=Array.prototype.slice;var toStr=Object.prototype.toString;var funcType="[object Function]";module.exports=function bind(that){var target=this;if(typeof target!=="function"||toStr.call(target)!==funcType){throw new TypeError(ERROR_MESSAGE+target)}var args=slice.call(arguments,1);var bound;var binder=function(){if(this instanceof bound){var result=target.apply(this,args.concat(slice.call(arguments)));if(Object(result)===result){return result}return this}else{return target.apply(that,args.concat(slice.call(arguments)))}};var boundLength=Math.max(0,target.length-args.length);var boundArgs=[];for(var i=0;i<boundLength;i++){boundArgs.push("$"+i)}bound=Function("binder","return function ("+boundArgs.join(",")+"){ return binder.apply(this,arguments); }")(binder);if(target.prototype){var Empty=function Empty(){};Empty.prototype=target.prototype;bound.prototype=new Empty;Empty.prototype=null}return bound}},{}],19:[function(require,module,exports){var implementation=require("./implementation");module.exports=Function.prototype.bind||implementation},{"./implementation":18}],20:[function(require,module,exports){"use strict";var fnToStr=Function.prototype.toString;var constructorRegex=/^\s*class /;var isES6ClassFn=function isES6ClassFn(value){try{var fnStr=fnToStr.call(value);var singleStripped=fnStr.replace(/\/\/.*\n/g,"");var multiStripped=singleStripped.replace(/\/\*[.\s\S]*\*\//g,"");var spaceStripped=multiStripped.replace(/\n/gm," ").replace(/ {2}/g," ");return constructorRegex.test(spaceStripped)}catch(e){return false}};var tryFunctionObject=function tryFunctionObject(value){try{if(isES6ClassFn(value)){return false}fnToStr.call(value);return true}catch(e){return false}};var toStr=Object.prototype.toString;var fnClass="[object Function]";var genClass="[object GeneratorFunction]";var hasToStringTag=typeof Symbol==="function"&&typeof Symbol.toStringTag==="symbol";module.exports=function isCallable(value){if(!value){return false}if(typeof value!=="function"&&typeof value!=="object"){return false}if(hasToStringTag){return tryFunctionObject(value)}if(isES6ClassFn(value)){return false}var strClass=toStr.call(value);return strClass===fnClass||strClass===genClass}},{}],21:[function(require,module,exports){"use strict";var getDay=Date.prototype.getDay;var tryDateObject=function tryDateObject(value){try{getDay.call(value);return true}catch(e){return false}};var toStr=Object.prototype.toString;var dateClass="[object Date]";var hasToStringTag=typeof Symbol==="function"&&typeof Symbol.toStringTag==="symbol";module.exports=function isDateObject(value){if(typeof value!=="object"||value===null){return false}return hasToStringTag?tryDateObject(value):toStr.call(value)===dateClass}},{}],22:[function(require,module,exports){"use strict";var regexExec=RegExp.prototype.exec;var tryRegexExec=function tryRegexExec(value){try{regexExec.call(value);return true}catch(e){return false}};var toStr=Object.prototype.toString;var regexClass="[object RegExp]";var hasToStringTag=typeof Symbol==="function"&&typeof Symbol.toStringTag==="symbol";module.exports=function isRegex(value){if(typeof value!=="object"){return false}return hasToStringTag?tryRegexExec(value):toStr.call(value)===regexClass}},{}],23:[function(require,module,exports){"use strict";var toStr=Object.prototype.toString;var hasSymbols=typeof Symbol==="function"&&typeof Symbol()==="symbol";if(hasSymbols){var symToStr=Symbol.prototype.toString;var symStringRegex=/^Symbol\(.*\)$/;var isSymbolObject=function isSymbolObject(value){if(typeof value.valueOf()!=="symbol"){return false}return symStringRegex.test(symToStr.call(value))};module.exports=function isSymbol(value){if(typeof value==="symbol"){return true}if(toStr.call(value)!=="[object Symbol]"){return false}try{return isSymbolObject(value)}catch(e){return false}}}else{module.exports=function isSymbol(value){return false}}},{}],24:[function(require,module,exports){"use strict";var has=Object.prototype.hasOwnProperty;var toStr=Object.prototype.toString;var slice=Array.prototype.slice;var isArgs=require("./isArguments");var isEnumerable=Object.prototype.propertyIsEnumerable;var hasDontEnumBug=!isEnumerable.call({toString:null},"toString");var hasProtoEnumBug=isEnumerable.call(function(){},"prototype");var dontEnums=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];var equalsConstructorPrototype=function(o){var ctor=o.constructor;return ctor&&ctor.prototype===o};var excludedKeys={$console:true,$external:true,$frame:true,$frameElement:true,$frames:true,$innerHeight:true,$innerWidth:true,$outerHeight:true,$outerWidth:true,$pageXOffset:true,$pageYOffset:true,$parent:true,$scrollLeft:true,$scrollTop:true,$scrollX:true,$scrollY:true,$self:true,$webkitIndexedDB:true,$webkitStorageInfo:true,$window:true};var hasAutomationEqualityBug=function(){if(typeof window==="undefined"){return false}for(var k in window){try{if(!excludedKeys["$"+k]&&has.call(window,k)&&window[k]!==null&&typeof window[k]==="object"){try{equalsConstructorPrototype(window[k])}catch(e){return true}}}catch(e){return true}}return false}();var equalsConstructorPrototypeIfNotBuggy=function(o){if(typeof window==="undefined"||!hasAutomationEqualityBug){return equalsConstructorPrototype(o)}try{return equalsConstructorPrototype(o)}catch(e){return false}};var keysShim=function keys(object){var isObject=object!==null&&typeof object==="object";var isFunction=toStr.call(object)==="[object Function]";var isArguments=isArgs(object);var isString=isObject&&toStr.call(object)==="[object String]";var theKeys=[];if(!isObject&&!isFunction&&!isArguments){throw new TypeError("Object.keys called on a non-object")}var skipProto=hasProtoEnumBug&&isFunction;if(isString&&object.length>0&&!has.call(object,0)){for(var i=0;i<object.length;++i){theKeys.push(String(i))}}if(isArguments&&object.length>0){for(var j=0;j<object.length;++j){theKeys.push(String(j))}}else{for(var name in object){if(!(skipProto&&name==="prototype")&&has.call(object,name)){theKeys.push(String(name))}}}if(hasDontEnumBug){var skipConstructor=equalsConstructorPrototypeIfNotBuggy(object);for(var k=0;k<dontEnums.length;++k){if(!(skipConstructor&&dontEnums[k]==="constructor")&&has.call(object,dontEnums[k])){theKeys.push(dontEnums[k])}}}return theKeys};keysShim.shim=function shimObjectKeys(){if(Object.keys){var keysWorksWithArguments=function(){return(Object.keys(arguments)||"").length===2}(1,2);if(!keysWorksWithArguments){var originalKeys=Object.keys;Object.keys=function keys(object){if(isArgs(object)){return originalKeys(slice.call(object))}else{return originalKeys(object)}}}}else{Object.keys=keysShim}return Object.keys||keysShim};module.exports=keysShim},{"./isArguments":25}],25:[function(require,module,exports){"use strict";var toStr=Object.prototype.toString;module.exports=function isArguments(value){var str=toStr.call(value);var isArgs=str==="[object Arguments]";if(!isArgs){isArgs=str!=="[object Array]"&&value!==null&&typeof value==="object"&&typeof value.length==="number"&&value.length>=0&&toStr.call(value.callee)==="[object Function]"}return isArgs}},{}],26:[function(require,module,exports){if(!String.prototype.includes){(function(){"use strict";var toString={}.toString;var defineProperty=function(){try{var object={};var $defineProperty=Object.defineProperty;var result=$defineProperty(object,object,object)&&$defineProperty}catch(error){}return result}();var indexOf="".indexOf;var includes=function(search){if(this==null){throw TypeError()}var string=String(this);if(search&&toString.call(search)=="[object RegExp]"){throw TypeError()}var stringLength=string.length;var searchString=String(search);var searchLength=searchString.length;var position=arguments.length>1?arguments[1]:undefined;var pos=position?Number(position):0;if(pos!=pos){pos=0}var start=Math.min(Math.max(pos,0),stringLength);if(searchLength+start>stringLength){return false}return indexOf.call(string,searchString,pos)!=-1};if(defineProperty){defineProperty(String.prototype,"includes",{value:includes,configurable:true,writable:true})}else{String.prototype.includes=includes}})()}},{}],27:[function(require,module,exports){if(!String.prototype.repeat){(function(){"use strict";var defineProperty=function(){try{var object={};var $defineProperty=Object.defineProperty;var result=$defineProperty(object,object,object)&&$defineProperty}catch(error){}return result}();var repeat=function(count){if(this==null){throw TypeError()}var string=String(this);var n=count?Number(count):0;if(n!=n){n=0}if(n<0||n==Infinity){throw RangeError()}var result="";while(n){if(n%2==1){result+=string}if(n>1){string+=string}n>>=1}return result};if(defineProperty){defineProperty(String.prototype,"repeat",{value:repeat,configurable:true,writable:true})}else{String.prototype.repeat=repeat}})()}},{}],28:[function(require,module,exports){if(!String.prototype.startsWith){(function(){"use strict";var defineProperty=function(){try{var object={};var $defineProperty=Object.defineProperty;var result=$defineProperty(object,object,object)&&$defineProperty}catch(error){}return result}();var toString={}.toString;var startsWith=function(search){if(this==null){throw TypeError()}var string=String(this);if(search&&toString.call(search)=="[object RegExp]"){throw TypeError()}var stringLength=string.length;var searchString=String(search);var searchLength=searchString.length;var position=arguments.length>1?arguments[1]:undefined;var pos=position?Number(position):0;if(pos!=pos){pos=0}var start=Math.min(Math.max(pos,0),stringLength);if(searchLength+start>stringLength){return false}var index=-1;while(++index<searchLength){if(string.charCodeAt(start+index)!=searchString.charCodeAt(index)){return false}}return true};if(defineProperty){defineProperty(String.prototype,"startsWith",{value:startsWith,configurable:true,writable:true})}else{String.prototype.startsWith=startsWith}})()}},{}],29:[function(require,module,exports){window.bashEmulator=require("./index")},{"./index":42}],30:[function(require,module,exports){var addLineNumbers=require("../utils/lineNumber");var numColumnWidth=6;var numberFlag="-n";function cat(env,args){var exitCode=0;var numberFlagIndex=args.findIndex(function(arg){return arg===numberFlag});var showNumbers=numberFlagIndex!==-1;if(showNumbers){args.splice(numberFlagIndex,1)}Promise.all(args.map(function(path){return env.system.read(path).then(null,function(err){exitCode=1;return"cat: "+err})})).then(function(contents){if(!showNumbers){return contents}return addLineNumbers(numColumnWidth,contents)}).then(function(contents){env.output(contents.join("\n"));env.exit(exitCode)})}module.exports=cat},{"../utils/lineNumber":43}],31:[function(require,module,exports){function cd(env,args){var path=args[0]||"/home/"+env.system.state.user;env.system.changeDir(path).then(env.exit,function(errorMessage){env.error(errorMessage);env.exit(1)})}module.exports=cd},{}],32:[function(require,module,exports){var SINGLE_COPY="SINGLE_COPY";function cp(env,args){var rFlagIndex=args.findIndex(function(arg){return arg==="-r"||arg==="-R"});var isRecursive=rFlagIndex!==-1;if(isRecursive){args.splice(rFlagIndex,1)}if(!args.length){env.error("cp: missing file operand");env.exit(1);return}if(args.length===1){env.error("cp: missing destination file operand after ‘"+args[0]+"’");env.exit(1);return}var destination=args[args.length-1];var files=args.slice(0,-1);function copy(file,dest){return env.system.stat(file).then(function(stats){if(stats.type==="dir"&&!isRecursive){return Promise.reject("cp: omitting directory ‘"+file+"’")}return env.system.copy(file,dest)})}env.system.stat(destination).then(function(stats){if(stats.type!=="dir"){return Promise.reject()}}).catch(function(){if(files.length!==1){return Promise.reject("cp: target ‘"+destination+"’ is not a directory")}return SINGLE_COPY}).then(function(actionType){if(actionType===SINGLE_COPY){return copy(files[0],destination)}return Promise.all(files.map(function(file){var filePathParts=file.split("/");var fileName=filePathParts[filePathParts.length-1];var dest=destination+"/"+fileName;return copy(file,dest)}))}).then(function(){env.exit(0)}).catch(function(err){env.error(err);env.exit(1)})}module.exports=cp},{}],33:[function(require,module,exports){var addLineNumbers=require("../utils/lineNumber");var numColumnWidth=5;function history(env){env.system.getHistory().then(function(history){env.output(addLineNumbers(numColumnWidth,history).join("\n"));env.exit()})}module.exports=history},{"../utils/lineNumber":43}],34:[function(require,module,exports){var commands={cat:require("./cat"),cd:require("./cd"),cp:require("./cp"),history:require("./history"),ls:require("./ls"),mkdir:require("./mkdir"),mv:require("./mv"),pwd:require("./pwd"),rm:require("./rm"),rmdir:require("./rmdir"),touch:require("./touch")};module.exports=commands},{"./cat":30,"./cd":31,"./cp":32,"./history":33,"./ls":35,"./mkdir":36,"./mv":37,"./pwd":38,"./rm":39,"./rmdir":40,"./touch":41}],35:[function(require,module,exports){var disclaimer="\n"+"The output here is limited."+"\n"+"On a real system you would also see file permissions, user, group, block size and more.";function ls(env,args){var aFlagIndex=args.findIndex(function(arg){return arg==="-a"});var showHidden=aFlagIndex!==-1;if(showHidden){args.splice(aFlagIndex,1)}var lFlagIndex=args.findIndex(function(arg){return arg==="-l"});var longFormat=lFlagIndex!==-1;if(longFormat){args.splice(lFlagIndex,1)}var laFlagIndex=args.findIndex(function(arg){return arg==="-la"});if(laFlagIndex!==-1){showHidden=true;longFormat=true;args.splice(laFlagIndex,1)}var alFlagIndex=args.findIndex(function(arg){return arg==="-al"});if(alFlagIndex!==-1){showHidden=true;longFormat=true;args.splice(alFlagIndex,1)}if(!args.length){args.push(".")}function excludeHidden(listing){if(showHidden){return listing}return listing.filter(function(item){return item[0]!=="."})}function formatListing(base,listing){if(!longFormat){return Promise.resolve(listing.join(" "))}return Promise.all(listing.map(function(filePath){return env.system.stat(base+"/"+filePath).then(function(stats){var date=new Date(stats.modified);var timestamp=date.toDateString().slice(4,10)+" "+date.toTimeString().slice(0,5);var type=stats.type;if(type==="dir"){type+=" "}return type+"  "+timestamp+"  "+stats.name})})).then(function(lines){return"total "+lines.length+"\n"+lines.join("\n")+disclaimer})}Promise.all(args.sort().map(function(path){return env.system.readDir(path).then(excludeHidden).then(function(listing){return formatListing(path,listing)}).then(function(formattedListing){if(args.length===1){return formattedListing}return path+":\n"+formattedListing})})).then(function(listings){return listings.join("\n\n")}).then(function(result){env.output(result);env.exit()},function(err){env.output("ls: "+err);env.exit(2)})}module.exports=ls},{}],36:[function(require,module,exports){function mkdir(env,args){if(!args.length){env.error("mkdir: missing operand");env.exit(1);return}Promise.all(args.map(function(path){return env.system.createDir(path)})).then(function(){env.exit()},function(err){env.error(err);env.exit(1)})}module.exports=mkdir},{}],37:[function(require,module,exports){var SINGLE_COPY="SINGLE_COPY";function mv(env,args){var nFlagIndex=args.findIndex(function(arg){return arg==="-n"});var noClobber=nFlagIndex!==-1;if(noClobber){args.splice(nFlagIndex,1)}if(!args.length){env.error("mv: missing file operand");env.exit(1);return}if(args.length===1){env.error("mv: missing destination file operand after ‘"+args[0]+"’");env.exit(1);return}var destination=args[args.length-1];var files=args.slice(0,-1);function rename(file,dest){if(noClobber){return env.system.stat(dest).catch(function(){return env.system.copy(file,dest).then(function(){return env.system.remove(file)})})}return env.system.copy(file,dest).then(function(){return env.system.remove(file)})}env.system.stat(destination).then(function(stats){if(stats.type!=="dir"){return Promise.reject()}}).catch(function(){if(files.length!==1){return Promise.reject("mv: target ‘"+destination+"’ is not a directory")}return SINGLE_COPY}).then(function(actionType){if(actionType===SINGLE_COPY){return rename(files[0],destination)}return Promise.all(files.map(function(file){var filePathParts=file.split("/");var fileName=filePathParts[filePathParts.length-1];var dest=destination+"/"+fileName;return rename(file,dest)}))}).then(function(){env.exit(0)}).catch(function(err){env.error(err);env.exit(1)})}module.exports=mv},{}],38:[function(require,module,exports){function pwd(env,args){env.system.getDir().then(function(dir){env.output(dir);env.exit()})}module.exports=pwd},{}],39:[function(require,module,exports){function rm(env,args){var rFlagIndex=args.findIndex(function(arg){return arg.toLowerCase()==="-r"});var recursive=rFlagIndex!==-1;if(recursive){args.splice(rFlagIndex,1)}if(!args.length){env.error("rm: missing operand");env.exit(1);return}Promise.all(args.map(function(path){return env.system.stat(path).then(function(stats){var isDir=stats.type==="dir";if(isDir&&!recursive){return Promise.reject("rm: cannot remove ‘"+path+"’: Is a directory")}},function(){}).then(function(){return env.system.remove(path)})})).then(function(){env.exit()},function(err){env.error(err);env.exit(1)})}module.exports=rm},{}],40:[function(require,module,exports){function rmdir(env,args){if(!args.length){env.error("rmdir: missing operand");env.exit(1);return}Promise.all(args.map(function(path){return env.system.stat(path).then(function(stats){if(stats.type!=="dir"){return Promise.reject("rmdir: cannot remove ‘"+path+"’: Not a directory")}},function(){}).then(function(){return env.system.readDir(path)}).then(function(files){if(files.length){return Promise.reject("rmdir: failed to remove ‘"+path+"’: Directory not empty");
}}).then(function(){return env.system.remove(path)})})).then(function(){env.exit()},function(err){env.error(err);env.exit(1)})}module.exports=rmdir},{}],41:[function(require,module,exports){function touch(env,args){if(!args.length){env.error("touch: missing file operand");env.exit(1);return}Promise.all(args.map(function(file){return env.system.write(file,"")})).then(function(){env.exit()},function(err){env.error(err);env.exit(1)})}module.exports=touch},{}],42:[function(require,module,exports){require("array.prototype.findindex");require("string.prototype.startswith");require("string.prototype.includes");require("string.prototype.repeat");var commands=require("./commands");function bashEmulator(initialState){var state=createState(initialState);var completion={};function getPath(path){return joinPaths(state.workingDirectory,path)}function parentExists(path){var parentPath=getPath(path).split("/").slice(0,-1).join("/");return emulator.stat(parentPath).then(function(stats){if(stats.type==="dir"){return Promise.resolve()}return Promise.reject(parentPath+": Is not a directory")})}var emulator={commands:commands,state:state,run:function(input){var args=input.split(" ");var cmd=args.shift();state.history.push(input);if(!commands[cmd]){return Promise.reject(cmd+": command not found")}var result="";return new Promise(function(resolve,reject){commands[cmd]({output:function(str){result+=str},error:function(str){result+=str},exit:function(code){if(code){reject(result)}else{resolve(result)}},system:emulator},args)})},getDir:function(){return Promise.resolve(state.workingDirectory)},changeDir:function(target){var normalizedPath=getPath(target);if(!state.fileSystem[normalizedPath]){return Promise.reject(normalizedPath+": No such file or directory")}state.workingDirectory=normalizedPath;return Promise.resolve()},read:function(arg){var filePath=getPath(arg);if(!state.fileSystem[filePath]){return Promise.reject(arg+": No such file or directory")}if(state.fileSystem[filePath].type!=="file"){return Promise.reject(arg+": Is a directory")}return Promise.resolve(state.fileSystem[filePath].content)},readDir:function(path){var dir=getPath(path);if(!state.fileSystem[dir]){return Promise.reject("cannot access ‘"+path+"’: No such file or directory")}var listing=Object.keys(state.fileSystem).filter(function(path){return path.startsWith(dir)&&path!==dir}).map(function(path){return path.substr(dir==="/"?dir.length:dir.length+1)}).filter(function(path){return!path.includes("/")}).sort();return Promise.resolve(listing)},stat:function(path){var filePath=getPath(path);if(!state.fileSystem[filePath]){return Promise.reject(path+": No such file or directory")}var pathParts=filePath.split("/");return Promise.resolve({modified:state.fileSystem[filePath].modified,type:state.fileSystem[filePath].type,name:pathParts[pathParts.length-1]})},createDir:function(path){return emulator.stat(path).then(function(){return Promise.reject("cannot create directory '"+path+"': File exists")},function(){return parentExists(path)}).then(function(){var dirPath=getPath(path);state.fileSystem[dirPath]={type:"dir",modified:Date.now()}})},write:function(path,content){if(typeof content!=="string"){try{content=JSON.stringify(content)}catch(e){return Promise.reject(e)}}return parentExists(path).then(function(){var filePath=getPath(path);return emulator.stat(path).then(function(stats){if(stats.type!=="file"){return Promise.reject(filePath+": Is a folder")}var oldContent=state.fileSystem[filePath].content;state.fileSystem[filePath].content=oldContent+content;state.fileSystem[filePath].modified=Date.now()},function(){state.fileSystem[filePath]={type:"file",modified:Date.now(),content:content}})})},remove:function(path){var filePath=getPath(path);if(!state.fileSystem[filePath]){return Promise.reject("cannot remove ‘"+path+"’: No such file or directory")}Object.keys(state.fileSystem).forEach(function(key){if(key.startsWith(filePath)){delete state.fileSystem[key]}});return Promise.resolve()},copy:function(source,destination){var sourcePath=getPath(source);var destinationPath=getPath(destination);if(!state.fileSystem[sourcePath]){return Promise.reject(source+": No such file or directory")}function renameAllSub(key){if(key.startsWith(sourcePath)){var destKey=key.replace(sourcePath,destinationPath);state.fileSystem[destKey]=state.fileSystem[key]}}return parentExists(destinationPath).then(function(){Object.keys(state.fileSystem).forEach(renameAllSub)})},getHistory:function(){return Promise.resolve(state.history)},completeUp:function(input){var historyChanged=completion.historySize!==state.history.length;var inputChanged=input!==completion.input;if(inputChanged||historyChanged){completion.input=input;completion.index=0;completion.historySize=state.history.length;completion.list=state.history.filter(function(item){return item.startsWith(input)}).reverse()}else if(completion.index<completion.list.length-1){completion.index++}else{return Promise.resolve(undefined)}return Promise.resolve(completion.list[completion.index])},completeDown:function(input){if(input!==completion.input||!completion.index){return Promise.resolve(undefined)}completion.index--;return Promise.resolve(completion.list[completion.index])}};return emulator}function createState(initialState){var state=defaultState();if(!initialState){return state}Object.keys(state).forEach(function(key){if(initialState[key]){state[key]=initialState[key]}});return state}function defaultState(){return{history:[],fileSystem:{"/":{type:"dir",modified:Date.now()},"/home":{type:"dir",modified:Date.now()},"/home/user":{type:"dir",modified:Date.now()}},user:"user",workingDirectory:"/home/user"}}function joinPaths(a,b){if(!b){return a}var path=(b.charAt(0)==="/"?"":a+"/")+b;var parts=path.split("/").filter(function noEmpty(p){return!!p});var up=0;for(var i=parts.length-1;i>=0;i--){var part=parts[i];if(part==="."){parts.splice(i,1)}else if(part===".."){parts.splice(i,1);up++}else if(up){parts.splice(i,1);up--}}return"/"+parts.join("/")}module.exports=bashEmulator},{"./commands":34,"array.prototype.findindex":2,"string.prototype.includes":26,"string.prototype.repeat":27,"string.prototype.startswith":28}],43:[function(require,module,exports){function addLineNumbers(width,list){return list.map(function(item,i){var num=i+1;var numChars=num.toString().length;var space=" ".repeat(width-numChars);return space+num+"  "+item})}module.exports=addLineNumbers},{}]},{},[29]);
